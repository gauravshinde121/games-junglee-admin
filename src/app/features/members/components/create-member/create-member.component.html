<main id="main" class="main m-0">
  <div *ngIf="!memberForm" class="border text-center p-5">
    <h4>Loading...</h4>
  </div>
  <form
    *ngIf="memberForm"
    [formGroup]="memberForm"
    (ngSubmit)="onSubmitMemberForm()"
  >
    <section class="section gamedetails">
      <div class="row">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-6 text-pink">
              <h4>
                <i class="fa fa-solid fa-user text-pink me-2"></i>
                <i class="fa fa-bars text-pink me-2"></i>
                {{ editMode ? "Update Member" : "Create Member" }}
              </h4>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-md-3 mb-2 mb-2">
              <label>Select Role</label>
              <select
                [attr.disabled]="editMode"
                formControlName="roleId"
                name="roleId"
                id="ab"
                class="form-select"
              >
                <option *ngFor="let role of roles" [value]="role.roleId">
                  {{ role.userRoleName }}
                </option>
              </select>
            </div>
            <div class="col-md-3 mb-2">
              <label>Username</label>
              <input
                [readOnly]="editMode"
                formControlName="username"
                type="text"
                class="form-control"
                placeholder="Username*"
              />
              <div
                class="text-danger"
                *ngIf="
                  memberForm.controls['username'].errors?.required &&
                  memberForm.controls['username'].touched
                "
              >
                Username is required
              </div>
            </div>
            <div class="col-md-3 mb-2">
              <label>Display Name</label>
              <input
                autocomplete="disabled"
                formControlName="displayName"
                type="text"
                class="form-control"
                placeholder="Display Name*"
              />
              <div
                class="text-danger"
                *ngIf="
                  memberForm.controls['displayName'].errors?.required &&
                  memberForm.controls['displayName'].touched
                "
              >
                Display Name is required
              </div>
            </div>
            <div class="col-md-3 mb-2" *ngIf="!editMode">
              <label>Password</label>
              <input
                type="password"
                class="form-control"
                formControlName="password"
                placeholder="Password*"
              />
              <div
                class="text-danger"
                *ngIf="
                  memberForm.controls['password'].errors?.required &&
                  memberForm.controls['password'].touched
                "
              >
                <small>Password is required</small>
              </div>
              <div
                class="text-danger"
                *ngIf="
                  memberForm.controls['password'].touched &&
                  memberForm.controls['password'].errors?.pattern
                "
              >
                <small
                  >Password should be atleast 8 characters long. <br />
                  It should Contain <br />
                  1 alpha-numeric character <br />
                  1 upper case character <br />
                  1 lower case character <br />
                  1 specialcharacter</small
                >
              </div>
            </div>
            <div class="col-md-3 mb-2" *ngIf="!editMode">
              <label>Confirm Password</label>
              <input
                type="password"
                class="form-control"
                formControlName="confirmPassword"
                placeholder="Confirm Password*"
              />
              <div
                *ngIf="
                  memberForm.controls['confirmPassword'].errors?.required &&
                  memberForm.controls['confirmPassword'].touched
                "
                class="text-danger"
              >
                Confirm Password is required
              </div>
              <div
                *ngIf="f['confirmPassword'].getError('Mustmatch') != null"
                class="small text-danger col-md-12 ps-5"
              >
                Confirm password doesn't match
              </div>
            </div>
            <!--<div class="col-md-3 mb-2">
              <label>Max Credit Limit</label>
              <input
                type="number"
                class="form-control"
                formControlName="playerMaxCreditLimit"
                placeholder="Player Max Credit Limit*"
              />
            </div>-->
            <div class="col-md-3 mb-2">
              <label>Available Credit</label>
              <input
                type="number"
                class="form-control"
                formControlName="playerAvailableCredit"
                placeholder="Player Max Credit Limit*"
              />
            </div>
            <div
              class="text-danger"
              *ngIf="memberForm.controls['minBet'].errors?.required"
            >
              Please enter credit limit
            </div>
          </div>
        </div>
      </div>
    </section>
    <section class="section gamedetails mt-3">
      <div class="row">
        <div class="col-md-12 text-pink">
          <h4>Game Status</h4>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3 mt-3 d-flex" *ngFor="let game of gamesList">
          <p class="me-2">{{ game.name }}</p>
          <div class="toggle-button-cover">
            <div class="button1 r" id="button-2">
              <input
                (click)="setGameStatus(game.isActive, game.gameId)"
                type="checkbox"
                class="checkbox"
                [checked]="!game.isActive"
              />
              <div class="knobs"></div>
              <div class="layer"></div>
            </div>
          </div>
          <!-- <div class="form-check form-switch"><input (click)="setGameStatus(game.isActive,game.sportsId)" class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckChecked" [checked]="game.isActive"></div> -->
        </div>
      </div>
    </section>
    <section class="section gamedetails mt-3">
      <div class="row">
        <div class="col-md-12 text-pink">
          <h4>Rate</h4>
        </div>
      </div>
      <div class="row">
        <div class="col-md-2">Sportsbook (INR)</div>
        <div class="col-md-2">Max Rate (INR) <br />My Share : 1</div>
        <div class="col-md-8">
          <input
            [readOnly]="true"
            formControlName="sportsBookRate"
            name="sportsBookRate"
            type="number"
            id="sportsBookRate"
            class="form-control pb-2"
          />
          <p>(Min : 1) (Max : 100)</p>
        </div>
      </div>
      <div class="row mt-5">
        <div class="col-md-2">Live Casino</div>
        <div class="col-md-2">Max Rate (INR) <br />My Share : 1</div>
        <div class="col-md-8">
          <input
            [readOnly]="true"
            formControlName="liveCasinoRate"
            name="liveCasinoRate"
            type="number"
            id=""
            class="form-control pb-2"
          />
          <p>(Min : 1) (Max : 100)</p>
        </div>
      </div>
      <div class="row mt-5" *ngIf="memberForm.value.roleId != 7">
        <div class="col-md-2">Partnership Percentage</div>
        <div class="col-md-2">(%)</div>
        <div class="col-md-8">
          <input
            formControlName="partnerShipPercent"
            name="partnerShipPercent"
            type="number"
            class="form-control pb-2"
            (keyup)="calculateMemberPercentage($event)"
          />
          <p>(Min : {{ uplineInfo?.partnerShipPercent }} ) (Max : 100)</p>
          <div
            *ngIf="f.partnerShipPercent?.errors?.min"
            class="small text-danger col-md-12 ps-5"
          >
            value cannot be less than {{ uplineInfo?.partnerShipPercent }}
          </div>
        </div>
        <div class="col-md-2">My Share</div>
        <div class="col-md-2">(%)</div>
        <div class="col-md-8">{{ memberPercentage }}</div>
      </div>
    </section>
    <section class="section gamedetails mt-3">
      <div class="row">
        <div class="col-md-4">
          <h4 class="text-pink">Min Bet</h4>
          <label>Member Min Bet</label>
          <input
            [readOnly]="this.isSuperAdmin == -1"
            formControlName="minBet"
            type="number"
            class="form-control"
            (blur)="onMinBetChange($event)"
          />
          <p>(Min: 100)</p>
          <!-- <div class="text-danger" *ngIf="MinBetVail && MinBetVail.invalid && MinBetVail.touched">
            Please enter valid Min Rate
           </div><span class="text-danger" *ngIf="memberForm.controls['minBet'].errors?.min"> Please enter valid Min Rate</span> -->
          <div
            *ngIf="
              (memberForm.controls['minBet'].touched ||
                memberForm.controls['minBet'].dirty) &&
              memberForm.controls['minBet'].invalid
            "
          >
            <div
              class="text-danger"
              *ngIf="memberForm.controls['minBet'].errors?.required"
            >
              Please enter valid Min Rate
            </div>
            <div
              class="text-danger"
              *ngIf="memberForm.controls['minBet'].errors?.['min']"
            >
              Please enter valid Min Rate
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <h4 class="text-pink">Max Bet</h4>
          <label> Member Max Bet Amt </label>
          <input
            [readOnly]="this.isSuperAdmin == -1"
            formControlName="maxBet"
            type="number"
            class="form-control"
          />
          <p>(Min: {{ maxBetMinValue }}) (Max: 10000000)</p>
          <!-- <div class="text-danger" *ngIf="MaxBetVail && MaxBetVail.invalid && MaxBetVail.touched">
            Please enter valid Bet Amount
          </div> -->
          <div
            *ngIf="
              (memberForm.controls['maxBet'].touched ||
                memberForm.controls['maxBet'].dirty) &&
              memberForm.controls['maxBet'].invalid
            "
          >
            <div
              class="text-danger"
              *ngIf="memberForm.controls['maxBet'].errors?.required"
            >
              Please enter valid Bet Amount
            </div>
            <div
              class="text-danger"
              *ngIf="memberForm.controls['maxBet'].errors?.['max']"
            >
              Please enter valid Bet Amount
            </div>
            <div
              class="text-danger"
              *ngIf="memberForm.controls['maxBet'].errors?.['min']"
            >
              Please enter valid Bet Amount
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <h4 class="text-pink">Max Exposure</h4>
          <label> Member Max Exposure Amt </label>
          <input
            [readOnly]="this.isSuperAdmin == -1"
            formControlName="maxExposure"
            type="number"
            class="form-control"
          />
          <p>(Min: 1) (Max: 50000000 )</p>
          <div
            *ngIf="
              (memberForm.controls['maxExposure'].touched ||
                memberForm.controls['maxExposure'].dirty) &&
              memberForm.controls['maxExposure'].invalid
            "
          >
            <div
              class="text-danger"
              *ngIf="memberForm.controls['maxExposure'].errors?.required"
            >
              Please enter valid Bet Amount
            </div>
            <div
              class="text-danger"
              *ngIf="memberForm.controls['maxExposure'].errors?.['max']"
            >
              Please enter valid Bet Amount
            </div>
            <div
              class="text-danger"
              *ngIf="memberForm.controls['maxExposure'].errors?.['min']"
            >
              Please enter valid Bet Amount
            </div>
          </div>
        </div>
      </div>
    </section>
    <div class="row my-3">
      <div class="col-md-6 col-6 text-end">
        <button
          type="button"
          class="btn btn-pink rounded-pill ps-5 pe-5 py-2"
          routerLink="member/list"
        >
          Cancel
        </button>
      </div>
      <div class="col-md-6 col-6">
        <button
          *ngIf="!editMode"
          type="submit"
          class="btn btn-pink rounded-pill ps-5 pe-5 py-2"
          [disabled]="!memberForm.valid"
        >
          Save
        </button>
        <button
          *ngIf="editMode"
          type="submit"
          class="btn btn-pink rounded-pill ps-5 pe-5 py-2"
          [disabled]="memberForm.invalid || memberForm.pristine"
        >
          Update
        </button>
      </div>
    </div>
    <!--your code will come here end-->
  </form>
</main>
